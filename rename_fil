s.py
import os
import re

def rename_files():
    sounds_dir = 'sounds'
    for root, _, files in os.walk(sounds_dir):
        # Sort files to handle numbered files consistently
        files.sort()
        for filename in files:
            if not filename.endswith('.ogg'):
                continue

            name, ext = os.path.splitext(filename)
            
            # Clean up the name
            # Remove prefixes like "- " or "ANML...-"
            clean_name = re.sub(r'^[a-zA-Z0-9_]+-.*?-', '', name)
            clean_name = re.sub(r'^-', '', clean_name).strip()

            # Extract number suffixes
            number_suffix = ''
            # Find numbers at the end of the string, possibly separated by comma or underscore
            match = re.search(r'([,_]\s*\d+)+$', clean_name)
            if match:
                numbers = re.findall(r'\d+', match.group(0))
                number_suffix = '_' + '_'.join(numbers)
                # Remove the matched part from the name
                clean_name = clean_name[:match.start()].strip()

            # Take the first 3-4 descriptive parts
            parts = [p.strip() for p in clean_name.split(',') if p.strip()]
            new_name_base = '_'.join(parts[:4])
            
            # Sanitize
            new_name_base = new_name_base.lower()
            new_name_base = re.sub(r'[\s-]+', '_', new_name_base)
            new_name_base = re.sub(r'[^a-z0-9_]', '', new_name_base)
            new_name_base = re.sub(r'__+', '_', new_name_base).strip('_')

            if not new_name_base:
                # Skip if the name becomes empty
                continue

            new_filename = new_name_base + number_suffix + ext
            
            old_path = os.path.join(root, filename)
            new_path = os.path.join(root, new_filename)

            if old_path == new_path:
                continue

            if os.path.exists(new_path):
                print(f"File '{new_path}' already exists. Skipping rename for '{filename}'.")
                # Try to add a number to make it unique
                i = 1
                while True:
                    temp_new_name = f"{new_name_base}{number_suffix}_{i}{ext}"
                    new_path_alt = os.path.join(root, temp_new_name)
                    if not os.path.exists(new_path_alt):
                        new_path = new_path_alt
                        new_filename = temp_new_name
                        break
                    i += 1
            
            print(f"Renaming '{filename}' to '{new_filename}'")
            try:
                os.rename(old_path, new_path)
            except Exception as e:
                print(f"Could not rename {old_path} to {new_path}: {e}")

if __name__ == '__main__':
    rename_files()
